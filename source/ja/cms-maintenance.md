<!--toc=cms_install-->

# メンテナンス

メンテナンスはどんなシステムでも重要な部分であり、データベースとファイルをトリム状態に保ち、エラーが発生したときにアラートを出し、バックグラウンドで実行するように常に設定されている必要があります。

[[PRODUCTNAME]]が稼働していると、ログや統計情報がサーバー上に徐々に蓄積され、ディスク容量を消費します。極端な話、これらの記録が膨大になると、CMS の Web インタフェースが遅くなったり、応答しなくなったりすることがあります。

また、**ディスプレイ**に問題が発生し、[[PRODUCTNAME]]サーバーにチェックインしなくなった場合、メールで通知されるので、問題を解決するためのアクションを取ることができますので、安心です。

メンテナンススクリプトは定期的に実行するようにスケジュールすることができ、古いログや統計情報の削除、ディスプレイの状態のチェックなどのバックグラウンドクリーンアップタスクを実行します。

## 設定方法

- メンテナンスは、CMSのメインメニューの**管理**セクションにある**設定**ページで**メンテナンス**タブから設定します。

メンテナンススクリプトに関連するオプションがいくつかあります。

- メンテナンス有効( `MAINTENANCE_ENABLED` ):

 - **オフ** - すべてのメンテナンス機能を無効にします。
 - **オン** - すべてのメンテナンス機能が有効です。以下のいずれかの方法を使用すると、キーを指定せずにスケジュールでメンテナ ンス スクリプトを呼び出すことができます。
 - **保護** - すべてのメンテナンス機能が有効です。メンテナンス スクリプトを呼び出すときに、正しいキーを指定する必要があります。これは、権限のない人がスクリプトを繰り返し呼び出して、大量のアラートメールを生成するのを防ぐためです。

- **メンテナンスキー**（`MAINTENANCE_KEY`）-「メンテナンス有効」が「保護」モードに設定されている場合に、メンテナンススクリプトを実行するために必要な秘密キーです。

- **Eメールアラート**（MAINTENANCE_EMAIL_ALERTS）-電子メールアラートの送信をグローバルに有効または無効にします。ディスプレイ管理で個々のディスプレイのアラートを有効化/無効化することができます。

- **最大ログ期間**(MAINTENANCE_LOG_MAXAGE) - 何日分のログメッセージを保存するか。指定より古いログは削除されます。0に設定すると、すべてのログが無期限に保存されます。

- **最大統計期間**（MAINTENANCE_STAT_MAXAGE） - 統計情報を保存する日数です。指定より古い統計は削除されます。0 に設定すると、すべての統計が無期限に保存されます。

- **ディスプレイタイムアウトの最大値**（MAINTENANCE_ALERT_TOUT）- ディスプレイがサーバに接続されてから何分後に問題が発生したと判断し、警告を送信するかをグローバルに設定します。ディスプレイ管理で、個々のディスプレイに対してこのデフォルトをオーバーライドできます。誤検出を避けるために、この時間はプレーヤーで設定した収集間隔より長くしてください。

**ネットワーク**タブから、CMSが生成する電子メールを送信するためのEメール・アドレス情報を設定します。

- **管理者Eメールアドレス**（mail_to） - 電子メール通知の全コピーを受信するCMS管理者の電子メールです。
- **送信Eメールアドレス**(mail_from) - アラートメールの送信元を示すアドレスです。(例:cms@auser.com)
- **送信Eメール** - 送信者として表示させたい名前です。(例:CMS管理者)

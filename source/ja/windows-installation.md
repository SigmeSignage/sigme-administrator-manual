<!--toc=windows_install-->

# Windowsプレーヤーのインストール

**Windowsプレーヤー**は、Windowsインストーラーファイル（MSI）として配布され、標準的な「ダブルクリック」によるインストールが可能です。

4つのステップを踏んでください。

- **準備** - 最小要件とMSI
- **インストール** - MSIをダブルクリックし、インストール作業を開始します。
- **接続** - あなたのプレーヤーをCMSに接続します。
- **認証** - CMSであなたのディスプレイを認証します。

**プレーヤーを起動**

## 1. 準備 - 最小要件
[[PRODUCTNAME]] の実行には多くのリソースを必要としませんが、技術の進歩に伴い、いくつかの最小要件を設定する必要がありま した。インストール時に確認されますが、便宜上、以下に列挙します。

- CMSへのネットワーク接続（インターネット接続の可能性あり）
- Microsoft Windows 10 以降（下記注参照）
- Windows 10 からは、OS の「プロフェッショナル」バージョンを使用することが推奨されますのでご注意ください。「home」バージョンでは、自動更新のスケジュールを完全に制御することができなくなったため、サイネージの再生が中断されるメッセージが発生する可能性があります。
- .NET フレームワーク v4.7.3
- Visual C++ Redistributable for Visual Studio 2015-2019 x86（存在しない場合はダウンロードされます。）
- Internet Explorer 8 以上（IE11 以上を推奨）
- Flash Player バージョン 9 以降（Flash サポートが必要な場合）
- Windows Media Player 11 以上
- PowerPoint 対応の場合、Microsoft PowerPoint 2003 以降。PowerPointビューアーは適しません。
- `edge`ブラウザタグとHLSに対応するためには、Webview2ランタイムが必要です。ダウンロードは[こちら](https://developer.microsoft.com/en-us/microsoft-edge/webview2/#download-section)
- Windows 10 build 1909以降を推奨します。Enterprise LTSBはビデオ再生に問題があることが知られています。

## 2. インストール方法

Xibo for Windows をダウンロードし、`Xibo msi` ファイルをダブルクリックします。

インストーラーが、以下のような画面を表示します。

**注意**：インストール中にセキュリティの警告や、発行元不明のアプリによる変更を許可するかどうかを尋ねるメッセージが表示されることがあります。その場合は、"実行 "または "はい "をクリックして、インストールを続行してください。

- インストーラーが「ようこそ」画面を表示しますので、「Next」をクリックします。

![Install Welcome](img/windows_installation_welcome_screen.png)

- `Read me`ファイルを読み、「Next」をクリックします。

![Install Read Me](img/windows_installation_read_me.png)

- **エンドユーザーライセンス契約書**を読み、同意する場合は 「Next」をクリックする。

![End User Agreement](img/windows_installation_end_user_agreement.png)

- 「Install」をクリックするか、「Back」をクリックして確認します。

![Begin Install](img/windows_installation_begin_install.png)

セットアップウィザードが起動し、Xiboプレイヤーのインストールが開始されます。

- インストールが完了したら、「Finish」をクリックしてセットアップウィザードを終了してください。

![](img/windows_installation_finish_setup.png)

{tip}
インストールされるフォルダは、デフォルトで `C:\Program Files(x86)/xibo Player/` になります。
{/tip}

## 3. CMSに接続する

新規にインストールしたプレーヤーは、**プレーヤーオプション**を使用して、**[[PRODUCTNAME]] CMS** に設定・登録する必要があります。

{tip}
**プレーヤーオプション**ウィンドウは、プレーヤーから「スタートメニュー」を使って「すべてのプログラム」を選択することでアクセスできます。
プレーヤーオプションのほとんどは、CMS上で設定され、ネットワーク経由でプレーヤーに配信されます。これにより、新規インストール時にプレイヤーの設定を最小限に抑えることができます。
{/tip}

CMSからオプションを送信する前に、以下のいずれかの方法でCMSインスタンスに**ディスプレイ**を登録する必要があります。

- コードを使用する。

または

- 手動設定(CMSアドレスとキー)

### コードを使用する

- プレーヤーオプションから**Connect**タブを選択し、**Use Code**をクリックすると、6文字のアクティベーションコードが表示されます。

![Instration Code](img/windows_installation_use_code.png)

{tip}
**ディスプレイ**ページでコードを入力し、プレーヤーが自動的に起動するまで、このフォームが開いたままであることを確認してください。このフォームを閉じると、コードが非表示になり、設定プロセスが停止します。
{/tip}

- CMSの**ディスプレイ**ページに移動して、**ディスプレイを追加(Code)**をクリックします。

![Display Code](img/windows_installation_add_display_code.png)

- **プレーヤーオプション**ウィンドウに表示されているコードを入力します。

![Enter code](img/windows_installation_add_enter_code.png)

- **保存**

設定に成功すると、プレーヤーの起動ページが自動的に閉じます。

ディスプレイが登録されるので、**ディスプレイの認証**ステップに進み、セットアップを続行します。

### 手動設定

**Player Options**ウィンドウの**Connect**タブから必要なフィールドを入力します。

- **CMS AddressCMS：** これは、CMS インストールの完全修飾アドレスです。例：`https://cms.example.org` または `http://example.org/cms`
- **CMS Key：** このディスプレイをCMSで認証するための秘密のCMSキーです。

{tip}
CMS Keyは、CMSのメインメニューの**管理**セクションの下にある**設定**タブの設定ページで確認することができます。
{/tip}

- **Local Library：**プレーヤーがローカルファイルを保存する場所。ファイルはCMSからダウンロードされ、CMSとの接続が切れてもプレーヤーが機能するようにします。
- すべての項目を入力したら、下の**Connect**ボタンをクリックしてください。

![Windows Player Options](img/windows_installation_manual_player_options.png)

{tip}
最初の接続に成功すると、メッセージが表示されます。
{/tip}

CMSとプレーヤー間の通信にエラーがない場合、ディスプレイは登録され、以下の**ディスプレイの認証**テップで説明する認証待ちの状態になります。

###プレーヤーの詳細設定

プレイヤー側で**Advanced**タブからしか設定できない項目がいくつかあるので、以下に説明します。

プレーヤーは、登録プロセスおよび新しいコンテンツを取得するために、CMSにアクセスする必要があります。プレーヤーがプロキシサーバーに接続されている場合、そのサーバーの詳細を以下のフィールドに入力することができます。

#### プロキシ設定

- プロキシサーバーとの認証に使用する**Username**。
- プロキシサーバーとの認証に使用される**Password**。
- プロキシサーバーの認証に使用する**Domain**。

####その他の設定

- **Display ID** - このディスプレイの一意のID。インストール時に自動生成された一意のIDが割り当てられますが、必要に応じて変更することができます。
- **Splash Screen** - プレーヤーPCにローカルに保存されている画像で、スプラッシュ画面を上書きすることができます。

## 4.ディスプレイの認証 

プレーヤーがスケジュールされたイベントを受信し、レイアウト/キャンペーンを表示する前に、CMSに接続するためにディスプレイを**認証**する必要があります。

**Player Options**ウィンドウからDisplay Adminをクリックするか、CMSにログインしてメインメニューから**Display**をクリックすると、リストに新しく登録されたプレイヤーが表示されます。

- 新しく追加されたプレーヤーの行メニューを使用し、リストから**認証**を選択します。

![Windows Display Authorise](img/windows_installation_display_authorise.png)

- **はい**をクリックして、このディスプレイの認証を確認します。

{tip}
この時点で、新しいプレーヤーが実行する**デフォルトレイアウト**を選択することができます。
{/tip}

### ディスプレイのプロファイルを設定する

一度登録されると、プレーヤーにはデフォルトの**ディスプレイ設定プロファイル**が与えられます。

{tip}
詳細は、[ユーザーマニュアル](/manual/ja/index.html)の[ディスプレイ設定](/manual/ja/displays_settings)のページを参照してください。
{/tip}

## Xiboプレイヤーの起動

**Player Options**から「Launch Player」を選択するか、「すべてのプログラム」から「Xibo Player」をクリックしてください。デフォルトレイアウトとそのメディアコンテンツ（および予約したもの）がダウンロードされる間、Xiboのスプラッシュスクリーンが表示されるはずです。

その後、プレーヤーはレイアウトコンテンツの再生を開始します。

## Windows上の変更

Windows / PowerPointをWindowsディスプレイで使用する場合の推奨設定をご紹介します。

- すべてのスクリーンセーバーをオフにします。
- 画面の省電力をオフにします。
- 「サウンドなし」のサウンドスキームを読み込む（コントロールパネル→サウンドとオーディオデバイスのプロパティ）。
- プレーンな壁紙を設定する（誰にも見られないことを祈るが、プレーヤーを再起動したり、Xiboを再起動したりする必要があるかもしれないので、正常な壁紙があると助かる）。
- ディスプレイを管理している場所からプレーヤーにアクセスできる場合は、UltraVNCサーバーをインストールして、時々プレーヤーに接続してチェックできるようにするとよいでしょう。VNCクライアントの「表示のみ」オプションを使用して、ディスプレイの邪魔をしないようにします。
- Xiboプレーヤーとして自動的にログオンするようにWindowsを設定する。
-通知領域のバルーンチップを無効にする。

## HTML5

Xiboは、Windowsが提供するWebブラウザを使用して、Webコンテンツ、テロップ、テキストなどを表示します。このブラウザコンポーネントのデフォルトは、ほとんどのシステムでInternet Explorer 9です。

## PowerPoint 

**PowerPoint**を表示するディスプレイは、PowerPointユーザーマニュアルのページのPrepare your Windows Playersセクションに従って、レジストリがWindows/PowerPointのバージョンに正しく変更されていることを確認してください。

## サムネイルデータベース

Windowsは、ユーザーフォルダ内のコンテンツのサムネイルを自動的に作成し、Xiboローカルライブラリにもそれを適用しようとします。

場合によっては、これはプレーヤーの正常な動作を妨げるので、無効にする必要があります。これは、以下のレジストリ設定によって実現できます。

```
[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer]
"NoThumbnailCache"=dword:00000001
"DisableThumbnailCache"=dword:00000001

[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced]
"DisableThumbnailCache"=dword:00000001
"NoThumbnailCache"=dword:00000001
```

**レジストリを変更する前に、自分が何をしているかを把握し、適切なバックアップをとっていることを確認してください。**

## 複数のプレーヤー

Windows上で、複数のプレーヤーを実行することができます。詳しくは、[Windowsプレーヤーマルチインストール](windows-player-multi-install.html)のページをご覧ください。

## スクリーンセーバー

Xiboをスクリーンセーバーとして動作させることができます。詳しくはWindowsプレーヤー - [スクリーンセーバー](windows-player-screen-saver.html)のページをご覧ください。

## ウォッチドッグ

ウォッチドッグは、システムトレイのアプリケーションで、メインアプリケーションの安定性を監視し、必要に応じて再起動するために使用できます。

- ウォッチドッグはプレーヤーアプリケーションによって設定され起動します。

